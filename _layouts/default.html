<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ site.title }}</title>
  <meta name="description" content="{{ site.description }}">
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}?v=2">
</head>
<body{% if page.body_class %} class="{{ page.body_class }}"{% endif %}>
  <div class="mobile-top-fade"></div>
  {{ content }}
  <script>
    // Hamburger menu
    (function() {
      var hamburger = document.querySelector('.hamburger');
      var nav = document.querySelector('.nav');
      if (!hamburger) return;
      hamburger.addEventListener('click', function() {
        nav.classList.toggle('nav--open');
      });
      nav.querySelectorAll('.nav__links a').forEach(function(link) {
        link.addEventListener('click', function() {
          nav.classList.remove('nav--open');
        });
      });
    })();
  </script>
  <script>
    // Force-play detail page videos on mobile
    document.querySelectorAll('.project-detail__media video').forEach(function(v) {
      var p = v.play();
      if (p) p.catch(function() {});
    });
  </script>
  <script>
    (function() {
      var videos = document.querySelectorAll('.banner-video');
      var captions = document.querySelectorAll('.banner-caption');
      if (videos.length < 2) return;
      var durations = [8000, 6800, 3500];
      var current = 0;

      // Pause all except the first
      videos.forEach(function(v, i) {
        if (i !== 0) v.pause();
      });

      // Force-play the first video (mobile needs explicit play)
      var firstPlay = videos[0].play();
      if (firstPlay) firstPlay.catch(function() {});

      function show(index) {
        videos[current].classList.remove('banner-video--active');
        if (captions[current]) captions[current].classList.remove('banner-caption--active');
        var prev = current;
        current = index;
        videos[current].currentTime = 0;
        var p = videos[current].play();
        if (p) p.catch(function() {});
        videos[current].classList.add('banner-video--active');
        if (captions[current]) captions[current].classList.add('banner-caption--active');
        setTimeout(function() { videos[prev].pause(); }, 1000);
        setTimeout(function() {
          show((current + 1) % videos.length);
        }, durations[current]);
      }

      setTimeout(function() {
        show(1);
      }, durations[0]);
    })();
  </script>
</body>
</html>
